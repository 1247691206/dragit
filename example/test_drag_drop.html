<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8">
<title>Testing Select2 and DS.JS</title>

<head>
  <link href="css/ds.css" rel="stylesheet">
</head>

<body>

  <script src="../lib/d3.v3.js"></script>

  <style>

  div.source {
    border-style: solid;
  }

  div.target {
    border-style: dotted;
  }

  </style>

  <script>

  var width = 800,
      height = 600;

  var w = 100, h = 80;

  var drag = d3.behavior.drag()
      .origin(function(d) { return d; })
      .on("dragend", dragend)
      .on("drag", dragmove);

  var data = [
      {x: 0, y: 0, color: "white"},      
      {x: width/2, y: 0, color: "white"},
      {x: 0, y: height/2, color: "white"},
      {x: width/2, y: height/2, color: "white"},
      {x: 0, y: 0, color: "red"}
  ];

  var div = d3.select("body").selectAll("div").data(data).enter().append("div")
      .style({
          width: w + "px",
          height: h + "px",
          "background-color": function(d, i){ return d.color},
          position: "absolute",
          left: function(d, i){ return d.x + "px"; },
          top: function(d, i) { return d.y + "px"; }
      })

  div.attr("class", function(d, i) {
    if(i == data.length-1)
      return "source";
    else
      return "target";
  })

  div.filter(function(d, i) { return i == data.length-1; }).call(drag);

  function dragmove(d) {
      d.x = d3.event.x;
      d.y = d3.event.y;
      leftVal = d.x + "px";
      topVal = d.y + "px";
      d3.select(this)
          .style({left: leftVal, top: topVal})
          .html("x: " + d.x + "<br /> y:" + d.y + "<br /> dx:" + d3.event.dx + "<br /> dy: " + d3.event.dy);
  }

  function dragend(d) {

    // TODO: snap to targets
    if(d.x < width/4 && d.y < height/4) {
      d.x = data[0].x;
      d.y = data[0].y;
    } else if(d.x >= width/4 && d.y < height/4) {
      d.x = data[1].x;
      d.y = data[1].y;
    } else if(d.x < width/4 && d.y >= height/4) {
      d.x = data[2].x;
      d.y = data[2].y;
    } else if(d.x >= width/4 && d.y >= height/4) {
      d.x = data[3].x;
      d.y = data[3].y;
    }
 
 
 
  
    d3.select(this)
        .transition().duration(500)
        .style({left: d.x+"px", top: d.y+"px"})
  

  }

  </script>  

</body>

</html>